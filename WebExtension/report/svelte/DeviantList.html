<script>
import DeviantEntry from "./DeviantEntry.html";
import { visible } from "../core.module.js";
import { afterUpdate } from 'svelte';

export let deviants;
export let deviant;
var oldDeviants;
export let watchedArtists;
export let opened;
var oldOpened;
export const registry = {};

afterUpdate( () => {
	if (opened != oldOpened) {
		let showTransition = (deviants == oldDeviants) && $visible;
		if (oldOpened) {
			registry[oldOpened].close(showTransition);
		}
		registry[opened].open(showTransition);
		oldOpened = opened;
	}
	oldDeviants = deviants;
} );
</script>

<svelte:options accessors="{true}"/>
<div class="deviantList" style="position: static;">
	{#each deviants as deviant (deviant.name)}
		<DeviantEntry {deviant} {registry} {watchedArtists}
			on:openMe="{ () => { opened = deviant.name; } }"/>
	{/each}
</div>