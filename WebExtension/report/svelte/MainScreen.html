<div id="mainScreen" class="{mode}Mode" class:usingTouch="$usingTouch">
	<div id="scanResults">
		<div id="favesLine">
			{favesLineParts[0]}<span class="dynamic">{favesLineParts[1]}</span>{favesLineParts[2]}
		</div>
		<div id="artistsLine">
			{artistsLineParts[0]}<span class="dynamic">{artistsLineParts[1]}</span>{artistsLineParts[2]}
		</div>
	</div>
	<div id="actionBar">
		{#each ["find", "options"] as action}
			<button type="button" class="action {action}Action" class:current="action == mode"
				on:click="useAction(action)">{$l10n(action + "Action")}</button>
		{/each}
	</div>
	<div id="lovedArtists" style="overflow-y: auto; overflow-x: hidden; position: relative;">
		{#if mode == "normal"}
			{#if watchError}
				<div id="watchFailure" class="notice">
					{$l10n(watchError == "notLoggedIn" ? "watchErrorNotLoggedIn" : "watchErrorInternal")}
				</div>
			{/if}
			<DeviantList deviants={deviantList} {watchedArtists} ref:normalList/>
		{:elseif mode == "find"}
			<FindModeContent ref:findModeContent {queryResults} {watchedArtists}
				on:close="set({mode: 'normal'})"/>
		{:elseif mode == "options"}
			<button type="button" class="closeButton" on:click="set({mode: 'normal'})">
				{$l10n("close")}</button>
			<div class="sectionHeader">{$l10n("subaccountsEditorHeader")}</div>
			<SubaccountsEditor prefsLoaded={true} {knownNames}/>
			<div class="sectionHeader">{$l10n("syncHeader")}</div>
			<SyncStatus/>
		{/if}
	</div>
	{#if mode == "normal" || !$mobile}
		<div id="tipOfTheMoment">
			<img id="totmIcon" alt="" width="16" height="16" src="/images/{$tip.icon}">
			<div id="totmText">{@html $tip.html}</div>
		</div>
	{/if}
</div>
<script>
import DeviantList from "./DeviantList.html";
import FindModeContent from "./FindModeContent.html";
import SubaccountsEditor from "../../options/svelte/SubaccountsEditor.html";
import SyncStatus from "../../options/svelte/SyncStatus.html";
export default {
	components: { DeviantList, FindModeContent, SubaccountsEditor, SyncStatus },
	computed: {
		favesLineParts({totalDeviations, pageType, $l10n}) {
			return $l10n("headerFavesLine", {num: totalDeviations, pageType}).split("*");
		},
		artistsLineParts({deviantList, pageType, $l10n}) {
			return $l10n("headerArtistsLine", {num: deviantList.length, pageType}).split("*");
		},
	},
	methods: {
		useAction(action) {
			if (action != this.get().mode) {
				this.set({mode: action});
			} else {
				this.set({mode: "normal"});
			}
		},
	},
};
</script>